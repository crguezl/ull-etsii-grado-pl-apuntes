<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Putting Things Together</TITLE>
<META NAME="description" CONTENT="Putting Things Together">
<META NAME="keywords" CONTENT="javascriptexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="previous" HREF="node63.html">
<LINK REL="up" HREF="node60.html">
<LINK REL="next" HREF="node65.html">
</HEAD>

<BODY >

<DIV CLASS="navigation">
<A NAME="tex2html1555"
  HREF="node65.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1549"
  HREF="node60.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1545"
  HREF="node63.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1551"
  HREF="node70.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1553"
  HREF="node73.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="https://dl.dropbox.com/u/14539152/PLgrado/PLgradoBOOK/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="google code project hosting"></A><A NAME="tex2html9"
  HREF="http://jquery.com/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://crondinosaur.blogspot.com/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1556"
  HREF="node65.html">Functions and all that</A>
<B>Sup:</B> <A NAME="tex2html1550"
  HREF="node60.html">Scheem Interpreter</A>
<B> Ant:</B> <A NAME="tex2html1546"
  HREF="node63.html">Setting Values</A>
<B> Con:</B> 
<A NAME="tex2html1551"
  HREF="node70.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<B> Ind:</B> 
<A NAME="tex2html1553"
  HREF="node73.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR> <P>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html1557"
  HREF="node64.html#SECTION05441000000000000000">Unit Testing: Mocha</A>
<LI><A NAME="tex2html1558"
  HREF="node64.html#SECTION05442000000000000000">karma</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION05440000000000000000">
Putting Things Together</A>
</H1>

<P>

<H2><A NAME="SECTION05441000000000000000">
Unit Testing: Mocha</A>
</H2>

<P>
Mocha is a feature-rich JavaScript test framework running on node.js
and the browser, making asynchronous testing simple and fun. Mocha tests
run serially, allowing for flexible and accurate
reporting, while mapping uncaught exceptions to the correct test cases.

<P>

<UL>
<LI><A NAME="tex2html143"
  HREF="http://visionmedia.github.io/mocha/">http://visionmedia.github.io/mocha/</A>
</LI>
<LI><A NAME="tex2html144"
  HREF="https://github.com/visionmedia/mocha">https://github.com/visionmedia/mocha</A>
</LI>
<LI><UL>
<LI>An example setup for unit testing JavaScript in the browser with the Mocha testing framework and Chai assertions:
<A NAME="tex2html145"
  HREF="https://github.com/ludovicofischer/mocha-chai-browser-demo">https://github.com/ludovicofischer/mocha-chai-browser-demo</A>
</LI>
<LI><A NAME="tex2html146"
  HREF="http://karma-runner.github.io/0.10/index.html">Karma - a test runner</A>
</LI>
</UL>
</LI>
</UL>

<P>
<PRE>
[~/srcPLgrado/mocha-chai-browser-demo(master)]$ mocha --help

  Usage: _mocha [debug] [options] [files]

  Commands:

    init &lt;path&gt;            initialize a client-side mocha setup at &lt;path&gt;

  Options:

    -h, --help                      output usage information
    -V, --version                   output the version number
    -r, --require &lt;name&gt;            require the given module
    -R, --reporter &lt;name&gt;           specify the reporter to use
    -u, --ui &lt;name&gt;                 specify user-interface (bdd|tdd|exports)
    -g, --grep &lt;pattern&gt;            only run tests matching &lt;pattern&gt;
    -i, --invert                    inverts --grep matches
    -t, --timeout &lt;ms&gt;              set test-case timeout in milliseconds [2000]
    -s, --slow &lt;ms&gt;                 "slow" test threshold in milliseconds [75]
    -w, --watch                     watch files for changes
    -c, --colors                    force enabling of colors
    -C, --no-colors                 force disabling of colors
    -G, --growl                     enable growl notification support
    -d, --debug                     enable node's debugger, synonym for node --debug
    -b, --bail                      bail after first test failure
    -A, --async-only                force all tests to take a callback (async)
    -S, --sort                      sort test files
    --recursive                     include sub directories
    --debug-brk                     enable node's debugger breaking on the first line
    --globals &lt;names&gt;               allow the given comma-delimited global [names]
    --check-leaks                   check for global variable leaks
    --interfaces                    display available interfaces
    --reporters                     display available reporters
    --compilers &lt;ext&gt;:&lt;module&gt;,...  use the given module(s) to compile files
    --inline-diffs                  display actual/expected differences inline within each string
    --no-exit                       require a clean shutdown of the event loop: mocha will not call process.exit
</PRE>

<P>
<PRE>
[~/srcPLgrado]$ mocha init chuchu
[~/srcPLgrado]$ ls -ltr
total 16
....
drwxr-xr-x   6 casiano  staff  204 20 ene 11:16 chuchu
[~/srcPLgrado]$ tree chuchu/
chuchu/
|-- index.html
|-- mocha.css
|-- mocha.js
`-- tests.js
</PRE>

<P>
<PRE>
[~/srcPLgrado/mocha-tutorial]$ cat test/test.js 
var assert = require("assert")
describe('Array', function(){
  describe('#indexOf()', function(){
    it('should return -1 when the value is not present', function(){
      assert.equal(-1, [1,2,3].indexOf(5));
      assert.equal(-1, [1,2,3].indexOf(0));
      assert.equal( 0, [1,2,3].indexOf(99));
    })
  })
})
</PRE>

<P>
<PRE>
[~/srcPLgrado/mocha-tutorial]$ mocha
  .
  0 passing (5ms)
  1 failing

  1) Array #indexOf() should return -1 when the value is not present:
     AssertionError: 0 == -1
      at Context.&lt;anonymous&gt; (/Users/casiano/local/src/javascript/PLgrado/mocha-tutorial/test/test.js:7:14)
</PRE>

<P>
Mocha allows you to use any assertion library you want, if it throws
an error, it will work! This means you can utilize libraries such as
should.js, node's regular assert module, or others. 

<P>

<H2><A NAME="SECTION05442000000000000000">
karma</A>
</H2>

<P>

<UL>
<LI><A NAME="5311"></A><SPAN  CLASS="textbf">Karma</SPAN> is essentially a tool which spawns a web server that executes source
code against test code for each of the browsers connected. 

<P>
</LI>
<LI>The results
for each test against each browser are examined and displayed via the
command line to the developer such that they can see which browsers and
tests passed or failed.

<P>
</LI>
<LI>A browser can be captured either
  
<UL>
<LI>manually, by visiting the URL where the Karma server is listening (typically <code>http://localhost:9876/</code>)
</LI>
<LI>or automatically by letting Karma know which browsers to start when Karma is run 
  
</LI>
</UL>
</LI>
</UL>

<P>

<UL>
<LI>Karma also watches all the files, specified within the configuration file,
and whenever any file changes, it triggers the test run by sending a
signal the testing server to inform all of the captured browsers to run
the test code again. 
</LI>
<LI>Each browser then loads the source files inside an
IFrame, executes the tests and reports the results back to the server.
</LI>
<LI>The server collects the results from all of the captured browsers and presents them to the developer.
</LI>
</UL>

<P>

<UL>
<LI><A NAME="tex2html147"
  HREF="http://youtu.be/5mHjJ4xf_K0">JS.everywhere(Europe) 2012: Testacular, the Spectacular JavaScript Test Runner - Vojta Jína</A>
YouTube
</LI>
</UL>

<P>
<PRE>
[~/srcPLgrado/mocha-chai-browser-demo(master)]$ karma --help
Karma - Spectacular Test Runner for JavaScript.

Usage:
  /usr/local/bin/karma &lt;command&gt;

Commands:
  start [&lt;configFile&gt;] [&lt;options&gt;] Start the server / do single run.
  init [&lt;configFile&gt;] Initialize a config file.
  run [&lt;options&gt;] [ -- &lt;clientArgs&gt;] Trigger a test run.
  completion Shell completion for karma.

Run --help with particular command to see its description and available options.

Options:
  --help     Print usage and options.
  --version  Print current version.
</PRE>

<P>
In order to serve us well, Karma needs to know about our project in
order to test it and this is done via a configuration file. 

<P>
The configuration file can be generated using karma init:
<PRE>
$ karma init my.conf.js

Which testing framework do you want to use ?
Press tab to list possible options. Enter to move to the next question.
&gt; jasmine
</PRE>

<P>
<PRE>
Do you want to use Require.js ?
This will add Require.js plugin.
Press tab to list possible options. Enter to move to the next question.
&gt; no
</PRE>

<P>

<DIV CLASS="navigation"><HR>
<A NAME="tex2html1555"
  HREF="node65.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1549"
  HREF="node60.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1545"
  HREF="node63.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1551"
  HREF="node70.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1553"
  HREF="node73.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="https://dl.dropbox.com/u/14539152/PLgrado/PLgradoBOOK/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="google code project hosting"></A><A NAME="tex2html9"
  HREF="http://jquery.com/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="http://crondinosaur.blogspot.com/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1556"
  HREF="node65.html">Functions and all that</A>
<B>Sup:</B> <A NAME="tex2html1550"
  HREF="node60.html">Scheem Interpreter</A>
<B> Ant:</B> <A NAME="tex2html1546"
  HREF="node63.html">Setting Values</A>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2014-01-20</I>
</ADDRESS>
</BODY>
</HTML>
