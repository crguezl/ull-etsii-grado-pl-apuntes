<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Troubleshooting</TITLE>
<META NAME="description" CONTENT="Troubleshooting">
<META NAME="keywords" CONTENT="javascriptexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node189.html">
<LINK REL="previous" HREF="node187.html">
<LINK REL="up" HREF="node184.html">
<LINK REL="next" HREF="node189.html">
</HEAD>

<BODY >

<DIV CLASS="navigation">
<A NAME="tex2html5938"
  HREF="node189.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5932"
  HREF="node184.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5926"
  HREF="node187.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5934"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5936"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="http://crguezl.github.io/pl-html/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html9"
  HREF="https://plus.google.com/u/0/communities/107031495100582318205"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1314"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html5939"
  HREF="node189.html">Configuration</A>
<B>Sup:</B> <A NAME="tex2html5933"
  HREF="node184.html">Heroku</A>
<B> Ant:</B> <A NAME="tex2html5927"
  HREF="node187.html">Heroku Postgress</A>
<B> Con:</B> 
<A NAME="tex2html5934"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<B> Ind:</B> 
<A NAME="tex2html5936"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR> <P>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html5940"
  HREF="node188.html#SECTION07141000000000000000">Crashing</A>
<UL>
<LI><A NAME="tex2html5941"
  HREF="node188.html#SECTION07141010000000000000">Failed to require a sourcefile</A>
<LI><A NAME="tex2html5942"
  HREF="node188.html#SECTION07141020000000000000">Encoding error</A>
<LI><A NAME="tex2html5943"
  HREF="node188.html#SECTION07141030000000000000">Missing a gem</A>
<LI><A NAME="tex2html5944"
  HREF="node188.html#SECTION07141040000000000000">Runtime dependencies on development/test gems</A>
<LI><A NAME="tex2html5945"
  HREF="node188.html#SECTION07141050000000000000">Versiones soportadas por Heroku</A>
<LI><A NAME="tex2html5946"
  HREF="node188.html#SECTION07141060000000000000">Rack::Sendfile</A>
</UL>
<BR>
<LI><A NAME="tex2html5947"
  HREF="node188.html#SECTION07142000000000000000"><FONT COLOR="#ff0000"> heroku run</FONT>: Timeout awaiting process</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION07140000000000000000">
Troubleshooting</A>
</H1>

<P>

<H2><A NAME="SECTION07141000000000000000">
Crashing</A>
</H2>
If you push your app and it crashes, 
<code>heroku ps</code> shows state crashed:
<PRE>
=== web (1X): `bundle exec thin start -R config.ru -e $RACK_ENV -p $PORT`
web.1: crashed 2013/10/24 20:21:34 (~ 1h ago)
</PRE>
check your logs to find out what went wrong. 

<P>
Here are some common
problems.

<P>

<H4><A NAME="SECTION07141010000000000000">
Failed to require a sourcefile</A>
</H4>
  

<P>
If your app failed to require a sourcefile, chances are good you’re
running Ruby 1.9.1 or 1.8 in your local environment. 

<P>
The load paths
have changed in Ruby 1.9 which applies to Ruby 2.0. 

<P>
Port your app
forward to Ruby 2.0.0 making certain it works locally before trying
to push to Cedar again.

<P>

<H4><A NAME="SECTION07141020000000000000">
Encoding error</A>
</H4>
  

Ruby 1.9 added more sophisticated encoding support to the language
which applies to Ruby 2.0. 

<P>
Not all gems work with Ruby 2.0. If you
hit an encoding error, you probably haven’t fully tested your app
with Ruby 2.0.0 in your local environment. 

<P>
Port your app forward
to Ruby 2.0.0 making certain it works locally before trying to push
to Cedar again.

<P>

<H4><A NAME="SECTION07141030000000000000">
Missing a gem</A>
</H4>
  

<P>
If your app crashes due to missing a gem, you may have it installed
locally but not specified in your Gemfile. 

<P>
You must isolate all
local testing using <code>bundle exec</code>. 

<P>
For example, don’t run <code>ruby web.rb</code>,
run 

<P>
<PRE>
bundle exec ruby web.rb
</PRE>
Don’t run <code>rake db:migrate</code>, run 
<PRE>
bundle exec rake db:migrate.
</PRE>
Another approach is to create a blank RVM gemset to be absolutely
sure you’re not touching any system-installed gems:
<PRE>
$ rvm gemset create myapp
$ rvm gemset use myapp
</PRE>

<P>

<H4><A NAME="SECTION07141040000000000000">
Runtime dependencies on development/test gems</A>
</H4>
  

<P>
If you’re still missing a gem when you deploy, check your Bundler
groups.

<P>
Heroku builds your app without the <code>development</code> or <code>test</code>
groups, and if you app depends on a gem from one of these groups
to run, you should move it out of the group.

<P>
One common example using the <code>RSpec tasks</code> in your Rakefile. 
If you see this in your Heroku deploy:
<PRE>
$ heroku run rake -T
Running `rake -T` attached to terminal... up, ps.3
rake aborted!
no such file to load -- rspec/core/rake_task
</PRE>
Then you’ve hit this problem. 

<P>
First, duplicate the problem locally like so:
<PRE>
$ bundle install --without development:test
...
$ bundle exec rake -T
rake aborted!
no such file to load -- rspec/core/rake_task
</PRE>
Now you can fix it by making these Rake tasks conditional on the gem load. 
For example:
<PRE>
begin
  require "rspec/core/rake_task"

  desc "Run all examples"
  RSpec::Core::RakeTask.new(:spec) do |t|
    t.rspec_opts = %w[--color]
    t.pattern = 'spec/*_spec.rb'
  end
rescue LoadError
end
</PRE>
Confirm it works locally, then push to Heroku.

<P>

<H4><A NAME="SECTION07141050000000000000">
Versiones soportadas por Heroku</A>
</H4>
  

<P>
Véase
<A NAME="tex2html757"
  HREF="https://devcenter.heroku.com/articles/ruby-support#ruby-versions">Heroku Ruby Support</A>
<P>

<H4><A NAME="SECTION07141060000000000000">
Rack::Sendfile</A>
</H4>
  

<P>
Heroku does not support the use of Rack::Sendfile. 

<P>
Rack:Sendfile
usually requires that there is a frontend webserver like nginx or
apache is running on the same machine as the application server.

<P>
This is not how Heroku is architected. Using the Rack::Sendfile
middleware will cause your file downloads to fail since it will
send a body with Content-Length of 0.

<P>

<H2><A NAME="SECTION07142000000000000000">

<FONT COLOR="#ff0000"> heroku run</FONT>: Timeout awaiting process</A>
</H2>

<P>
The 
<FONT COLOR="#ff0000"> heroku run command opens a connection to Heroku on port 5000</FONT>. If
your local network or ISP is blocking port 5000 (el caso de la ULL), 
or you are experiencing
a connectivity issue, you will see an error similar to:

<P>
<PRE>
[~/srcPLgrado/pegjscalc(master)]$ heroku run console
Running `console` attached to terminal... up, run.4357
 !    
 !    Timeout awaiting process
</PRE>

<P>
You can test your connection to Heroku by trying to connect directly to
port 5000 by using <code>telnet</code> to <code>rendezvous.runtime.heroku.com</code>. 

<P>
Desde la universidad fracasa:

<P>
<PRE>
[~/srcPLgrado/pegjscalc(master)]$ telnet rendezvous.runtime.heroku.com 5000Trying 50.19.103.36...
telnet: connect to address 50.19.103.36: Operation timed out
telnet: Unable to connect to remote host
</PRE>

<P>
A successful session will look like this:

<P>
<PRE>
$ telnet rendezvous.runtime.heroku.com 5000
Trying 50.19.103.36...
Connected to ec2-50-19-103-36.compute-1.amazonaws.com.
Escape character is '^]'.
</PRE>
If you do not get this output, your computer is being blocked from
accessing our services. We recommend contacting your IT department, ISP,
or firewall manufacturer to move forward with this issue.

<P>

<DIV CLASS="navigation"><HR>
<A NAME="tex2html5938"
  HREF="node189.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5932"
  HREF="node184.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5926"
  HREF="node187.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5934"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5936"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="http://crguezl.github.io/pl-html/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html9"
  HREF="https://plus.google.com/u/0/communities/107031495100582318205"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1314"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html5939"
  HREF="node189.html">Configuration</A>
<B>Sup:</B> <A NAME="tex2html5933"
  HREF="node184.html">Heroku</A>
<B> Ant:</B> <A NAME="tex2html5927"
  HREF="node187.html">Heroku Postgress</A>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2014-03-29</I>
</ADDRESS>
</BODY>
</HTML>
