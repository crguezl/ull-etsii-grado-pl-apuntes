<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Práctica: Comma Separated Values. CSV</TITLE>
<META NAME="description" CONTENT="Práctica: Comma Separated Values. CSV">
<META NAME="keywords" CONTENT="javascriptexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node12.html">
<LINK REL="previous" HREF="node10.html">
<LINK REL="up" HREF="node7.html">
<LINK REL="next" HREF="node12.html">
</HEAD>

<BODY >

<DIV CLASS="navigation">
<A NAME="tex2html1002"
  HREF="node12.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html996"
  HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html990"
  HREF="node10.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html998"
  HREF="node90.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1000"
  HREF="node93.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/perlexamples/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="Apuntes de LPP"></A><A NAME="tex2html3"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5669"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle 2014/2015"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle 2013/2014"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="https://plus.google.com/u/0/communities/103299470687051533933"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1415"></A><A NAME="tex2html7"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html8"
  HREF="http://www.ull.es/view/centros/etsii/Grado_en_Ingenieria_Informatica/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html9"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html10"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1003"
  HREF="node12.html">Comentarios y Consejos</A>
<B>Sup:</B> <A NAME="tex2html997"
  HREF="node7.html">Expresiones Regulares y Análisis</A>
<B> Ant:</B> <A NAME="tex2html991"
  HREF="node10.html">Práctica: Conversor de Temperaturas</A>
<B> Con:</B> 
<A NAME="tex2html998"
  HREF="node90.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<B> Ind:</B> 
<A NAME="tex2html1000"
  HREF="node93.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR> <P>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><A NAME="tex2html1004"
  HREF="node11.html#SECTION04140010000000000000">Donde</A>
<LI><A NAME="tex2html1005"
  HREF="node11.html#SECTION04140020000000000000">Introducción al formato CSV</A>
<LI><A NAME="tex2html1006"
  HREF="node11.html#SECTION04140030000000000000">Ejemplo de ejecución</A>
<LI><A NAME="tex2html1007"
  HREF="node11.html#SECTION04140040000000000000">Aproximación al análisis mediante expresiones regulares de CSV</A>
<LI><A NAME="tex2html1008"
  HREF="node11.html#SECTION04140050000000000000">index.html</A>
<LI><A NAME="tex2html1009"
  HREF="node11.html#SECTION04140060000000000000">jQuery</A>
<LI><A NAME="tex2html1010"
  HREF="node11.html#SECTION04140070000000000000">How JQuery Works</A>
<LI><A NAME="tex2html1011"
  HREF="node11.html#SECTION04140080000000000000">JSON.stringify()</A>
<LI><A NAME="tex2html1012"
  HREF="node11.html#SECTION04140090000000000000">Underscore</A>
<LI><A NAME="tex2html1013"
  HREF="node11.html#SECTION041400100000000000000">Tareas</A>
</UL></UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION04140000000000000000"></A>
   <A NAME="3263"></A>
  
<A NAME="sectionpractica:csv"></A>
<BR>
Práctica: Comma Separated Values. CSV
</H1>

<P>

<H4><A NAME="SECTION04140010000000000000">
Donde</A>
</H4>
  

<P>
<PRE>
[~/srcPLgrado/csv(master)]$ pwd -P
/Users/casiano/local/src/javascript/PLgrado/csv
</PRE>

<P>
Véase
<A NAME="tex2html73"
  HREF="https://bitbucket.org/casiano/pl-grado-csv/src">https://bitbucket.org/casiano/pl-grado-csv/src</A>
y
<A NAME="tex2html74"
  HREF="https://github.com/crguezl/csv">https://github.com/crguezl/csv</A>.

<P>

<H4><A NAME="SECTION04140020000000000000">
Introducción al formato CSV</A>
</H4>
  

<P>
Véase <A NAME="tex2html75"
  HREF="http://en.wikipedia.org/wiki/Comma-separated_values">Comma Separated Values</A>
en la Wikipedia:

<P>
<I>A comma-separated values (CSV) file stores tabular data (numbers
and text) in plain-text form. 
 A CSV file consists of any number of
records, separated by line breaks of some kind; each record consists
of fields, separated by a comma. All records have an identical
sequence of fields.</I>

<P>

<H4><A NAME="SECTION04140030000000000000">
Ejemplo de ejecución</A>
</H4>
  

<P>
Véase la página en 
<A NAME="tex2html76"
  HREF="http://crguezl.github.io/csv/">http://crguezl.github.io/csv/</A>.
Pruebe a dar como entrada cualquiera de estas dos
<PRE>
[~/srcPLgrado/csv(gh-pages)]$ cat input.txt 
"producto",           "precio"
"camisa",             "4,3"
"libro de O\"Reilly", "7,2"
</PRE>

<P>
<PRE>
[~/srcPLgrado/csv(gh-pages)]$ cat input2.txt 
"producto",           "precio"  "fecha"
"camisa",             "4,3",    "14/01"
"libro de O\"Reilly", "7,2"     "13/02"
</PRE>

<P>
Pruebe también a dar alguna entrada errónea.

<P>

<DIV ALIGN="CENTER"><A NAME="figure:csv"></A><A NAME="1213"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figura:</STRONG>
Ejemplo de pantalla de La aplicación para el Análisis de Datos en Formato CSV</CAPTION>
<TR><TD><IMG
 WIDTH="769" HEIGHT="410" BORDER="0"
 SRC="csv.png"
 ALT="\begin{figure}\begin{center}
\centerline{\epsfig{file=chapter2/csv.eps, width=17cm}}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<H4><A NAME="SECTION04140040000000000000">
Aproximación al análisis mediante expresiones regulares de CSV</A>
</H4>
  

Una primera aproximación sería hacer <code>split</code> por las comas:
<PRE>
&gt; x = '"earth",1,"moon",9.374'
'"earth",1,"moon",9.374'
&gt; y = x.split(/,/)
[ '"earth"', '1', '"moon"', '9.374' ]
</PRE>

<P>
Esta solución deja las comillas dobles en los campos entrecomillados. 
Peor aún, los campos entrecomillados pueden contener comas, en cuyo 
caso la división proporcionada por <code>split</code> sería errónea:
<PRE>
&gt; x = '"earth, mars",1,"moon, fobos",9.374'
'"earth, mars",1,"moon, fobos",9.374'
&gt; y = x.split(/,/)
[ '"earth', ' mars"', '1', '"moon', ' fobos"', '9.374' ]
</PRE>

<P>
La siguiente expresión regular reconoce cadenas de comillas dobles
con secuencias de escape seguidas opcionalmente de una coma:
<PRE>
&gt; x = '"earth, mars",1,"moon, fobos",9.374'
'"earth, mars",1,"moon, fobos",9.374'
&gt; r = /"((?:[^"\\]|\\.)*)"\s*,?/g
/"((?:[^"\\]|\\.)*)"\s*,?/g
&gt; w = x.match(r)
[ '"earth, mars",', '"moon, fobos",' ]
</PRE>
If your regular expression uses the <code>g</code> flag, you can use the <code>exec</code> 
or <code>match</code> methods
multiple times to find successive matches in the same string. When
you do so, the search starts at the substring of string specified by the
regular expression's <code>lastIndex</code> property.

<P>
Javascript sub-matches stop working when the <code>g</code> modifier is set:
<PRE>
&gt; text = 'test test test test'
'test test test test'
&gt; text.match(/t(e)(s)t/)
[ 'test', 'e', 's', index: 0, input: 'test test test test' ]
&gt; text.match(/t(e)(s)t/g)
[ 'test', 'test', 'test', 'test' ]
</PRE>
Sin embargo el método <code>exec</code> de las expresiones regulares si que 
conserva las subexpresiones que casan con los paréntesis:
<PRE>
&gt; r = /t(e)(s)t/g
/t(e)(s)t/g
&gt; text = 'test test test test'
'test test test test'
&gt; while (m = r.exec(text)) {
... console.log(m);
... }
[ 'test', 'e', 's', index: 0, input: 'test test test test' ]
[ 'test', 'e', 's', index: 5, input: 'test test test test' ]
[ 'test', 'e', 's', index: 10, input: 'test test test test' ]
[ 'test', 'e', 's', index: 15, input: 'test test test test' ]
undefined
</PRE>
Another catch to remember is that <code>exec()</code> doesn't return the matches in
one big array: it keeps returning matches until it runs out, in which
case it returns <code>null</code>.

<P>
Véase

<UL>
<LI><A NAME="tex2html77"
  HREF="http://stackoverflow.com/questions/844001/javascript-regex-and-submatches">Javascript Regex and Submatches</A>
en StackOverflow.
</LI>
<LI>La sección 
<I>Ejercicios</I>
<A HREF="node13.html#section:ejercicioslastindex">1.6</A>
</LI>
</UL>

<P>
Esta otra expresión regular <code>/([^,]+),?|\s*,/</code> actúa de forma parecida al <code>split</code>. 
Reconoce secuencias no vacías de caracteres que no contienen comas seguidas opcionalmente
de una coma o bien una sóla coma (precedida opcionalmente de blancos):
<PRE>
&gt; x = '"earth, mars",1,"moon, fobos",9.374'
'"earth, mars",1,"moon, fobos",9.374'
&gt; r = /([^,]+),?|\s*,/g
/([^,]+),?|\s*,/g
&gt; w = x.match(r)
[ '"earth,', ' mars",', '1,', '"moon,', ' fobos",', '9.374' ]
</PRE>

<P>
La siguiente expresión regular es la unión de dos: 

<UL>
<LI>Cadenas de dobles comillas seguidas de una coma opcional entre espacios en blanco
</LI>
<LI>Cadenas que no tienen comas
</LI>
</UL>
<PRE>
&gt;  x = '"earth, mars",1,"moon, fobos",9.374'
'"earth, mars",1,"moon, fobos",9.374'
&gt; r = /\s*"((?:[^"\\]|\\.)*)"\s*,?|\s*([^,]+),?|\s*,/g
/\s*"((?:[^"\\]|\\.)*)"\s*,?|\s*([^,]+),?|\s*,/g
&gt; w = x.match(r)
[ '"earth, mars",', '1,', '"moon, fobos",', '9.374' ]
</PRE>
El operador <code>|</code> trabaja en circuito corto:
<PRE>
&gt; r = /(ba?)|(b)/
/(ba?)|(b)/
&gt; r.exec("ba")
[ 'ba', 'ba', undefined, index: 0, input: 'ba' ]
&gt; r = /(b)|(ba?)/
/(b)|(ba?)/
&gt; r.exec("ba")
[ 'b', 'b', undefined, index: 0, input: 'ba' ]
</PRE>

<P>
Si usamos <code>exec</code> tenemos:
<PRE>
&gt; x = '"earth, mars",1,"moon, fobos",9.374'
'"earth, mars",1,"moon, fobos",9.374'
&gt; r = /\s*"((?:[^"\\]|\\.)*)"\s*,?|\s*([^,]+),?|\s*,/g
/\s*"((?:[^"\\]|\\.)*)"\s*,?|\s*([^,]+),?|\s*,/g
&gt; while (m = r.exec(x)) { console.log(m); }
[ '"earth, mars",', 'earth, mars', undefined, index: 0,
  input: '"earth, mars",1,"moon, fobos",9.374' ]
[ '1,', undefined, '1', index: 14,
  input: '"earth, mars",1,"moon, fobos",9.374' ]
[ '"moon, fobos",', 'moon, fobos', undefined, index: 16,
  input: '"earth, mars",1,"moon, fobos",9.374' ]
[ '9.374', undefined, '9.374', index: 30,
  input: '"earth, mars",1,"moon, fobos",9.374' ]
undefined
</PRE>

<P>

<OL>
<LI><A NAME="tex2html78"
  HREF="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Regexp">RegExp Objects</A>
<P>
The <code>RegExp</code> constructor creates a regular expression object for matching text with a pattern.

<P>
Literal and constructor notations are possible:

<P>
<PRE>
/pattern/flags; 
new RegExp(pattern [, flags]);
</PRE>

<P>

<UL>
<LI>The literal notation provides compilation of the regular expression
when the expression is evaluated. 

<P>
</LI>
<LI>Use literal notation when the regular
expression will remain constant. 

<P>
</LI>
<LI>For example, if you use literal notation
to construct a regular expression used in a loop, the regular expression
won't be recompiled on each iteration.
</LI>
</UL>

<P>

<UL>
<LI>The constructor of the regular expression object, for example,
<code>new RegExp("ab+c")</code>, provides runtime compilation of the regular
expression. 

<P>
</LI>
<LI>Use the constructor function when you know the regular
expression pattern will be changing, or you don't know the pattern and
are getting it from another source, such as user input.

<P>
</LI>
<LI>When using the constructor function, the normal string escape rules
(preceding special characters with <code>\</code> when included in a string) are
necessary. For example, the following are equivalent:

<P>
<PRE>
var re = /\w+/;
var re = new RegExp("\\w+");
</PRE>
</LI>
</UL>

<P>
</LI>
<LI><A NAME="tex2html79"
  HREF="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec">exec</A>
</LI>
<LI><A NAME="tex2html80"
  HREF="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/search">search</A>
<P>
<code>str.search(regexp)</code>

<P>
If successful, search returns the index of the regular expression inside
the string. Otherwise, it returns <code>-1</code>.

<P>
When you want to know whether a pattern is found in a string use search
(similar to the regular expression <code>test</code> method); for more information
(but slower execution) use <code>match</code> (similar to the regular expression
<code>exec</code> method).
</LI>
<LI><A NAME="tex2html81"
  HREF="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match">match</A>
</LI>
<LI><A NAME="tex2html82"
  HREF="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace">replace</A>
<P>
The <code>replace()</code> method returns a new string with some or all matches of
a pattern replaced by a replacement.  
The pattern can be a string or a <code>RegExp</code>, 
and the replacement can be a string or a function to be called
for each match.

<P>
<PRE>
&gt; re = /apples/gi
/apples/gi
&gt; str = "Apples are round, and apples are juicy."
'Apples are round, and apples are juicy.'
&gt; newstr = str.replace(re, "oranges")
'oranges are round, and oranges are juicy.'
</PRE>

<P>
The replacement string can be a function to be invoked to create the
new substring (to put in place of the substring received from parameter
<code>#1</code>). The arguments supplied to this function are:

<P>
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142>Possible name</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=482>Supplied value</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142>match</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=482>The matched substring. (Corresponds to <code>$&amp;</code>.)</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142>p1, p2, ...</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=482>The nth parenthesized submatch string, provided the first argument to replace was a RegExp object. (Corresponds to <code>$1</code>, <code>$2</code>, etc.) 
For example, if <code>/(\a+)(\b+)/</code>, was given, p1 is the match for
<code>\a+</code>, and p2 for <code>\b+</code>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142>offset</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=482>The offset of the matched substring within the total string being examined. 
                  (For example, if the total string was <code>abcd</code>, and the
                  matched substring was <code>bc</code>, then this argument will
                  be <code>1</code>.)</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=142>string</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=482>The total string being examined</TD>
</TR>
</TABLE>

<P>
<PRE>
[~/javascript/learning]$ pwd -P
/Users/casiano/local/src/javascript/learning
[~/javascript/learning]$ cat f2c.js 
#!/usr/bin/env node
function f2c(x)
{
  function convert(str, p1, offset, s)
  {
    return ((p1-32) * 5/9) + "C";
  }
  var s = String(x);
  var test = /(\d+(?:\.\d*)?)F\b/g;
  return s.replace(test, convert);
}

var arg = process.argv[2] || "32F";
console.log(f2c(arg));
</PRE>

<P>
<PRE>
[~/javascript/learning]$ ./f2c.js 100F
37.77777777777778C
[~/javascript/learning]$ ./f2c.js 
0C
</PRE>
</LI>
</OL>

<P>

<H4><A NAME="SECTION04140050000000000000">
index.html</A>
</H4>
  

<PRE>
&lt;html&gt;
  &lt;head&gt;
     &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
     &lt;title&gt;CSV Analyzer&lt;/title&gt;
     &lt;link href="global.css" rel="stylesheet" type="text/css"&gt;

     &lt;script type="text/javascript" src="../../underscore/underscore.js"&gt;&lt;/script&gt;
     &lt;script type="text/javascript" src="../../jquery/starterkit/jquery.js"&gt;&lt;/script&gt;
     &lt;script type="text/javascript" src="csv.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Comma Separated Value Analyzer&lt;/h1&gt;
    &lt;div&gt;
      &lt;i&gt;Write a CSV string. Click the table button. The program outputs a table with the specified data.&lt;/i&gt;
    &lt;/div&gt;
    &lt;table&gt;
      &lt;tr&gt;
        &lt;th&gt;CSV string:&lt;/th&gt; &lt;!-- autofocus attribute is HTML5 --&gt;
        &lt;td&gt;&lt;textarea autofocus cols = "80" rows = "5" id="original"&gt;&lt;/textarea&gt;&lt;/td&gt; 
      &lt;/tr&gt;
    &lt;/table&gt;
    &lt;button type="button"&gt;table:&lt;/button&gt;&lt;br&gt;
    &lt;span class="output" id="finaltable"&gt;&lt;/span&gt;
  &lt;/body&gt;
&lt;/html&gt;
</PRE>

<P>

<H4><A NAME="SECTION04140060000000000000">
jQuery</A>
</H4>
  

<P>
<A NAME="tex2html83"
  HREF="http://jquery.com/">jQuery</A>
(<A NAME="tex2html84"
  HREF="http://jquery.com/download/">Descarga la librería</A>)

<P>
<A NAME="3290"></A><SPAN  CLASS="textbf">jQuery</SPAN> is a cross-platform JavaScript library designed to simplify
the client-side scripting of HTML. 

<P>

<UL>
<LI>It was released in January 2006
at BarCamp NYC by John Resig. 

<P>
</LI>
<LI>It is currently developed by a team of
developers led by Dave Methvin. 

<P>
</LI>
<LI>jQuery is the most popular JavaScript library in
use today

<P>
</LI>
<LI>jQuery's syntax is designed to make it easier to navigate a document,
select DOM elements, create animations, handle events, and develop Ajax
applications. 

<P>
</LI>
<LI>The set of jQuery core features — DOM element selections, traversal
and manipulation — enabled by its selector engine (named "Sizzle"
from v1.3), created a new "programming style", fusing algorithms and
DOM-data-structures; and influenced the architecture of other JavaScript
frameworks like <A NAME="tex2html85"
  HREF="http://en.wikipedia.org/wiki/YUI_Library">YUI v3</A>
and <A NAME="tex2html86"
  HREF="http://en.wikipedia.org/wiki/Dojo_Toolkit">Dojo</A>.
</LI>
</UL>

<P>

<H4><A NAME="SECTION04140070000000000000">
How JQuery Works</A>
</H4>
  

<P>

<UL>
<LI>Véase
  <A NAME="tex2html87"
  HREF="http://learn.jquery.com/about-jquery/how-jquery-works/">How jQuery Works</A>
</LI>
<LI><A NAME="tex2html88"
  HREF="https://github.com/crguezl/how-jquery-works-tutorial">https://github.com/crguezl/how-jquery-works-tutorial</A>
en GitHub
</LI>
<LI><PRE>
  [~/javascript/jquery(master)]$ pwd -P
  /Users/casiano/local/src/javascript/jquery
</PRE>
</LI>
<LI><A NAME="tex2html89"
  HREF="http://www.w3schools.com/jquery/default.asp">w3schools JQuery tutorial</A>
</LI>
</UL>

<P>
<PRE>
~/javascript/jquery(master)]$ cat index.html 
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;title&gt;Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;a href="http://jquery.com/"&gt;jQuery&lt;/a&gt;
    &lt;script src="starterkit/jquery.js"&gt;&lt;/script&gt;
    &lt;script&gt;
 
    // Your code goes here.
 
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</PRE>

<P>
To ensure that their code runs after the browser finishes loading the document, many JavaScript programmers wrap their code in an onload function:

<P>
<PRE>
window.onload = function() { alert( "welcome" ); }
</PRE>

<P>
Unfortunately, the code doesn't run until all images are finished downloading, including banner ads. To run code as soon as the document is ready to be manipulated, jQuery has a statement known as the ready event:

<P>
<PRE>
$( document ).ready(function() {
    // Your code here.
});
</PRE>
For <code>click</code> and most other events, you can prevent the default
behavior by calling 
<A NAME="tex2html90"
  HREF="http://api.jquery.com/event.preventdefault/">event.preventDefault()</A>
in the event handler.
If this method is called, the default action of the event will not be triggered.
For example, clicked anchors will not take the browser to a new URL.

<P>
<PRE>
[~/javascript/jquery(master)]$ cat index2.html 
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;title&gt;Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;a href="http://jquery.com/"&gt;jQuery&lt;/a&gt;
    &lt;script src="starterkit/jquery.js"&gt;&lt;/script&gt;
    &lt;script&gt;
 
    $( document ).ready(function() {
        $( "a" ).click(function( event ) {
            alert( "The link will no longer take you to jquery.com" );
            event.preventDefault();
        });
    });
 
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</PRE>
Borrowing from CSS 1–3, and then adding its own, jQuery offers a powerful set of tools for matching a set of elements in a document.

<P>
See jQuery <A NAME="tex2html91"
  HREF="http://api.jquery.com/category/selectors/">Category: Selectors</A>.

<P>
Another common task is adding or removing a class.
jQuery also provides some handy effects.

<P>
<PRE>
[~/javascript/jquery(master)]$ cat index3.html 
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;style&gt;
        a.test { font-weight: bold; }
    &lt;/style&gt;
    &lt;title&gt;Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;a href="http://jquery.com/"&gt;jQuery&lt;/a&gt;
    &lt;script src="starterkit/jquery.js"&gt;&lt;/script&gt;
    &lt;script&gt;
 
    $( document ).ready(function() {
        $( "a" ).click(function( event ) {
            $( "a" ).addClass( "test" );
            alert( "The link will no longer take you to jquery.com" );
            event.preventDefault();
            $( "a" ).removeClass( "test" );
            $( this ).hide( "slow" );
            $( this ).show( "slow" );
        });
    });
 
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</PRE>

<UL>
<LI>In JavaScript <code>this</code> always refers to the <I>owner</I> of the function
we're executing, or rather, <I>to the object that a function is a method of</I>.

<P>
</LI>
<LI>When we define our function <code>tutu()</code> in a page, its owner is the
page, or rather, the <code>window</code> object (or <code>global</code> object) of JavaScript. 

<P>
</LI>
<LI>An <code>onclick</code> property, though, is owned by the HTML element it belongs to.

<P>
</LI>
<LI>The method
<A NAME="tex2html92"
  HREF="http://api.jquery.com/addclass/">.addClass( className )</A>
adds the specified class(es) to each of the set of matched elements.

<P>
<code>className</code> is a String containing 
one or more space-separated classes to be added to the class attribute of each matched element.

<P>
This method does not replace a class. It simply adds the class, appending
it to any which may already be assigned to the elements.
</LI>
<LI>The method <code>.removeClass( [className ] )</code>
removes a single class, multiple classes, or all classes from each element in the set of matched elements.

<P>
If a class name is included as a parameter, then only that class will be
removed from the set of matched elements. If no class names are specified
in the parameter, all classes will be removed.

<P>
This method is often used with <code>.addClass()</code> 
to switch elements' classes from one to another, like so:

<P>
<PRE>
$( "p" ).removeClass( "myClass noClass" ).addClass( "yourClass" );
</PRE>

<P>
</LI>
</UL>

<P>
JavaScript enables you to freely
pass functions around to be executed at a later time. A <A NAME="3300"></A><SPAN  CLASS="textbf">callback</SPAN> is a
function that is passed as an argument to another function and is usually 
executed
after its parent function has completed. 

<P>
Callbacks are special because
they wait to execute until their parent finishes or some event occurs. 

<P>
Meanwhile, the
browser can be executing other functions or doing all sorts of other work.
<PRE>
[~/javascript/jquery(master)]$ cat app.rb
require 'sinatra'

set :public_folder, File.dirname(__FILE__) + '/starterkit'

get '/' do
  erb :index
end

get '/chuchu' do
  if request.xhr?
    "hello world!"
  else 
    erb :tutu
  end
end

__END__

@@layout
  &lt;!DOCTYPE html&gt;
  &lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8" /&gt;
        &lt;title&gt;Demo&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;a href="http://jquery.com/"&gt;jQuery&lt;/a&gt;
        &lt;div class="result"&gt;&lt;/div&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;%= yield %&gt;
    &lt;/body&gt;
  &lt;/html&gt;

@@index
  &lt;script&gt;
  $( document ).ready(function() {
      $( "a" ).click(function( event ) {
          event.preventDefault();
          $.get( "/chuchu", function( data ) {
            $( ".result" ).html( data );
            alert( "Load was performed." );
          });
      });
  });
  &lt;/script&gt;

@@tutu
  &lt;h1&gt;Not an Ajax Request!&lt;/h1&gt;
</PRE>

<P>

<UL>
<LI><code>jQuery.get( url [, data ] [, success(data, textStatus, jqXHR) ] [, dataType ] )</code>
load data from the server using a HTTP GET request.

<P>
</LI>
<LI><code>url</code>

<P>
Type: String

<P>
A string containing the URL to which the request is sent.
</LI>
<LI><code>data</code>

<P>
Type: PlainObject or String

<P>
A plain object or string that is sent to the server with the request.
</LI>
<LI><code>success(data, textStatus, jqXHR)</code>

<P>
Type: Function()

<P>
A callback function that is executed if the request succeeds.
</LI>
<LI><code>dataType</code>

<P>
Type: String

<P>
The type of data expected from the server. Default: Intelligent Guess 
(<code>xml</code>, <code>json</code>, <code>script</code>, <code>or</code> <code>html</code>).
</LI>
</UL>

<P>
To use callbacks, it is important to know how to pass them into their parent function.

<P>
Executing callbacks with arguments can be tricky.

<P>
This code example will not work:

<P>
<PRE>
$.get( "myhtmlpage.html", myCallBack( param1, param2 ) );
</PRE>
The reason this fails is that the code executes 

<P>
<PRE>
myCallBack( param1, param2)
</PRE>

<P>
immediately and then passes <code>myCallBack()</code>'s return value as the second
parameter to <code>$.get()</code>. 

<P>
We actually want to pass the function <code>myCallBack</code>,
not <code>myCallBack( param1, param2 )</code>'s return value (which might or might not
be a function). 

<P>
So, how to pass in <code>myCallBack()</code> and include arguments?

<P>
To defer executing <code>myCallBack()</code> with its parameters, you can use
an anonymous function as a wrapper.

<P>
<PRE>
[~/javascript/jquery(master)]$ cat app2.rb
require 'sinatra'

set :public_folder, File.dirname(__FILE__) + '/starterkit'

get '/' do
  erb :index
end

get '/chuchu' do
  if request.xhr? # is an ajax request
    "hello world!"
  else 
    erb :tutu
  end
end

__END__

@@layout
  &lt;!DOCTYPE html&gt;
  &lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8" /&gt;
        &lt;title&gt;Demo&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;a href="http://jquery.com/"&gt;jQuery&lt;/a&gt;
        &lt;div class="result"&gt;&lt;/div&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;%= yield %&gt;
    &lt;/body&gt;
  &lt;/html&gt;

@@tutu
  &lt;h1&gt;Not an Ajax Request!&lt;/h1&gt;

@@index
  &lt;script&gt;
    var param = "chuchu param";
    var handler = function( data, textStatus, jqXHR, param ) {
      $( ".result" ).html( data );
      alert( "Load was performed.\n"+
             "$data = "+data+
             "\ntextStatus = "+textStatus+
             "\njqXHR = "+JSON.stringify(jqXHR)+
             "\nparam = "+param );
    };
    $( document ).ready(function() {
        $( "a" ).click(function( event ) {
            event.preventDefault();
            $.get( "/chuchu", function(data, textStatus, jqXHR ) {
              handler( data, textStatus, jqXHR, param);
            });
        });
    });
  &lt;/script&gt;
</PRE>
El ejemplo en <code>app2.rb</code> puede verse desplegado en Heroku:
<A NAME="tex2html93"
  HREF="http://jquery-tutorial.herokuapp.com/">http://jquery-tutorial.herokuapp.com/</A>
<P>

<H4><A NAME="SECTION04140080000000000000">
JSON.stringify()</A>
</H4>
  

<A NAME="parrafo:jsonstringify"></A>The
<A NAME="tex2html94"
  HREF="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">JSON.stringify() </A>
method converts a value to  <TT>JSON</TT> , optionally replacing values
if a <code>replacer function</code> is specified, or optionally including only the
specified properties if a <code>replacer array</code> is specified.

<P>
<code>JSON.stringify(value[, replacer [, space]])</code>

<UL>
<LI><code>value</code>

<P>
The value to convert to a JSON string.
</LI>
<LI><code>replacer</code>

<P>

<UL>
<LI>If a function, transforms values and properties encountered while stringifying; 
</LI>
<LI>if an array, specifies the set of properties included in objects in the final string.
  
</LI>
</UL>

<P>
</LI>
<LI><code>space</code>

<P>
Causes the resulting string to be pretty-printed.
</LI>
</UL>

<P>
See another example of use in
<A NAME="tex2html95"
  HREF="http://jsfiddle.net/casiano/j7tsF/">http://jsfiddle.net/casiano/j7tsF/</A>.
To learn to use JSFiddle wath the YouTube video 
<A NAME="tex2html96"
  HREF="http://youtu.be/Iw4f-yRf7RU">How to use JSFiddle by Jason Diamond</A>
<P>

<H4><A NAME="SECTION04140090000000000000">
Underscore</A>
</H4>
  

<P>
<A NAME="tex2html97"
  HREF="http://underscorejs.org/">Underscore</A>:
is a utility-belt library for JavaScript that provides a
lot of the functional programming support that you would expect in
Ruby.

<P>

<UL>
<LI>Underscore provides functions that support 
methods like: 

<P>
<code>map</code>, <code>select</code>, <code>invoke</code>  

<P>
</LI>
<LI>as well as more specialized helpers:

<P>

<UL>
<LI>function binding
</LI>
<LI>javascript templating
</LI>
<LI>deep equality testing
</LI>
<LI>and so on. 
</LI>
</UL>

<P>

<UL>
<LI>Cargando la librería:
<PRE>
[~/javascript/jquery(master)]$ node
&gt; 2+3
5
&gt; _
5
&gt; uu = require('underscore')
{ [Function]
  _: [Circular],
  VERSION: '1.5.2',
  forEach: [Function],
  each: [Function],
  collect: [Function],
  map: [Function],
  inject: [Function],
  reduce: [Function],
  .................
  chain: [Function] }
</PRE>

<P>
</LI>
<LI><code>each</code>:

<P>
<PRE>
&gt; uu.each([1, 2, 3], function(x) { console.log(x*x); })
1
4
9
</PRE>

<P>
</LI>
<LI><code>map</code>:
<PRE>
&gt; uu.map([1, 2, 3], function(num){ return num * 3; })
[ 3, 6, 9 ]
</PRE>
</LI>
<LI><code>invoke</code>
<PRE>
&gt; z = [[6,9,1],[7,3,9]]
[ [ 6, 9, 1 ], [ 7, 3, 9 ] ]
&gt; uu.invoke(z, 'sort')
[ [ 1, 6, 9 ], [ 3, 7, 9 ] ]
&gt; uu.invoke(z, 'sort', function(a, b) { return b-a; })
[ [ 9, 6, 1 ], [ 9, 7, 3 ] ]
</PRE>
</LI>
<LI><code>reduce</code>:
<PRE>
&gt; uu.reduce([1, 2, 3, 4], function(s, num){ return s + num; }, 0)
10
&gt; uu.reduce([1, 2, 3, 4], function(s, num){ return s * num; }, 1)
24
&gt; uu.reduce([1, 2, 3, 4], function(s, num){ return Math.max(s, num); }, -1)
4
&gt; uu.reduce([1, 2, 3, 4], function(s, num){ return Math.min(s, num); }, 99)
1
</PRE>

<P>
</LI>
<LI><code>filter</code>: (<code>select</code> is an alias for <code>filter</code>)
<PRE>
&gt; uu.filter([1, 2, 3, 4, 5, 6], function(num){ return num % 2 == 0; })
[ 2, 4, 6 ]
</PRE>
</LI>
<LI><code>isEqual</code>
<PRE>
&gt; a = {a:[1,2,3], b: { c: 1, d: [5,6]}}
{ a: [ 1, 2, 3 ],
  b: { c: 1, d: [ 5, 6 ] } }
&gt; b = {a:[1,2,3], b: { c: 1, d: [5,6]}}
{ a: [ 1, 2, 3 ],
  b: { c: 1, d: [ 5, 6 ] } }
&gt; a == b
false
&gt; uu.isEqual(a,b)
true
</PRE>
</LI>
<LI><code>bind</code>
<PRE>
&gt; func = function(greeting){ return greeting + ': ' + this.name }
[Function]
&gt; func = uu.bind(func, {name: 'moe'})
[Function]
&gt; func('hello')
'hello: moe'
&gt; func = uu.bind(func, {name: 'moe'}, 'hi')
[Function]
&gt; func()
'hi: moe'
&gt;
</PRE>
</LI>
</UL>
</LI>
</UL>
<H4><A NAME="SECTION041400100000000000000">
Tareas</A>
</H4>
  

<P>

<UL>
<LI>Añada pruebas usando Mocha y Chai
</LI>
<LI>Use Karma para la ejecución de las tareas
</LI>
<LI>Use Gulp para la gestión de las tareas 
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<A NAME="tex2html1002"
  HREF="node12.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html996"
  HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html990"
  HREF="node10.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html998"
  HREF="node90.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1000"
  HREF="node93.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/perlexamples/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="Apuntes de LPP"></A><A NAME="tex2html3"
  HREF="https://campusvirtual.ull.es/1415/course/view.php?id=5669"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle 2014/2015"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle 2013/2014"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="https://plus.google.com/u/0/communities/103299470687051533933"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1415"></A><A NAME="tex2html7"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html8"
  HREF="http://www.ull.es/view/centros/etsii/Grado_en_Ingenieria_Informatica/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html9"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html10"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html1003"
  HREF="node12.html">Comentarios y Consejos</A>
<B>Sup:</B> <A NAME="tex2html997"
  HREF="node7.html">Expresiones Regulares y Análisis</A>
<B> Ant:</B> <A NAME="tex2html991"
  HREF="node10.html">Práctica: Conversor de Temperaturas</A>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2015-02-22</I>
</ADDRESS>
</BODY>
</HTML>
