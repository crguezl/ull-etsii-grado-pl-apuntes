<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>OmniAuth gem: Standardized Multi-Provider Authentication for Ruby</TITLE>
<META NAME="description" CONTENT="OmniAuth gem: Standardized Multi-Provider Authentication for Ruby">
<META NAME="keywords" CONTENT="javascriptexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node203.html">
<LINK REL="previous" HREF="node201.html">
<LINK REL="up" HREF="node200.html">
<LINK REL="next" HREF="node203.html">
</HEAD>

<BODY >

<DIV CLASS="navigation">
<A NAME="tex2html6229"
  HREF="node203.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html6223"
  HREF="node200.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html6217"
  HREF="node201.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html6225"
  HREF="node217.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html6227"
  HREF="node220.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="http://crguezl.github.io/pl-html/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html9"
  HREF="https://plus.google.com/u/0/communities/107031495100582318205"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1314"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html6230"
  HREF="node203.html">OmniAuth OAuth2 gem</A>
<B>Sup:</B> <A NAME="tex2html6224"
  HREF="node200.html">Oauth: Google, Twitter, GitHub,</A>
<B> Ant:</B> <A NAME="tex2html6218"
  HREF="node201.html">Introduction to OAuth</A>
<B> Con:</B> 
<A NAME="tex2html6225"
  HREF="node217.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<B> Ind:</B> 
<A NAME="tex2html6227"
  HREF="node220.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR> <P>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><A NAME="tex2html6231"
  HREF="node202.html#SECTION07420010000000000000">Getting Started</A>
<LI><A NAME="tex2html6232"
  HREF="node202.html#SECTION07420020000000000000">Strategies</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html6233"
  HREF="node202.html#SECTION07421000000000000000">Auth Hash Schema</A>
<UL>
<LI><A NAME="tex2html6234"
  HREF="node202.html#SECTION07421010000000000000">Ejemplos</A>
<LI><A NAME="tex2html6235"
  HREF="node202.html#SECTION07421020000000000000">Documentación de la Gema</A>
<LI><A NAME="tex2html6236"
  HREF="node202.html#SECTION07421030000000000000">Véase</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION07420000000000000000">
OmniAuth gem: Standardized Multi-Provider Authentication for Ruby</A>
</H1>

<P>

<UL>
<LI><A NAME="tex2html800"
  HREF="http://intridea.github.io/omniauth/">OmniAuth</A>
</LI>
</UL>

<P>
OmniAuth is a library that standardizes multi-provider authentication
for web applications. Any developer can create <A NAME="22609"></A><SPAN  CLASS="textbf">strategies</SPAN> for
OmniAuth that can
authenticate users via disparate systems. 

<P>
OmniAuth strategies have been created for everything from Facebook to LDAP.

<P>
To use OmniAuth, you need only 

<OL>
<LI>to redirect users to <code>/auth/:provider</code>,
where <code>:provider</code> is the name of the strategy 
(for example, <code>developer</code> or <code>twitter</code>). 

<P>
</LI>
<LI>From there, OmniAuth will take over and take the
user through the necessary steps to authenticate them with the chosen strategy.

<P>
</LI>
<LI>Once the user has authenticated, 
OmniAuth sets a special hash called the <A NAME="22611"></A><SPAN  CLASS="textbf">Authentication Hash</SPAN> 
on the Rack environment of a request to <code>/auth/:provider/callback</code>. 

<P>
</LI>
<LI>This hash
contains as much information about the user as OmniAuth was able to
glean from the utilized strategy. 

<P>
</LI>
<LI>
<FONT COLOR="#ff0000"> You should set up an endpoint in your
application that matches to the callback URL and then
performs whatever steps are necessary for your application</FONT>. 
</LI>
</OL>

<P>

<H4><A NAME="SECTION07420010000000000000">
Getting Started</A>
</H4>
  

<P>
To use OmniAuth in a project with a Gemfile, just add each of the

<FONT COLOR="#0000ff"> strategies</FONT> you want to use individually:

<P>
<PRE>
gem 'omniauth-github'
gem 'omniauth-openid'
</PRE>

<P>
Now you can use the <code>OmniAuth::Builder</code> 
Rack middleware 
<FONT COLOR="#0000ff"> to build up your
list of OmniAuth strategies for use in your application</FONT>:

<P>
Para saber mas sobre Rack y sobre Middlewares Rack,
véanse las secciones 

<UL>
<LI>Rack en <A HREF="node96.html#chapter:rack">15</A>,
</LI>
<LI><I>Middleware y la Clase Rack::Builder</I> en <A HREF="node114.html#section:middleware">15.18</A> 
y
</LI>
<LI><I>La Estructura de una Aplicación Rack</I>
en
<A HREF="node110.html#section:estructuradeunaapprack">15.14</A>
</LI>
</UL>

<P>
<PRE>
use OmniAuth::Builder do
  provider:github, ENV['GITHUB_KEY'], ENV['GITHUB_SECRET']
  provider:openid, :store =&gt; OpenID::Store::Filesystem.new('/tmp')
end
</PRE>
By default, OmniAuth will return auth information to the path
<code>/auth/:provider/callback</code> inside the Rack environment. 

<P>
In Sinatra, for
example, a callback might look something like this:

<P>
<PRE>
# Support both GET and POST for callbacks
%w(get post).each do |method|
  send(method, "/auth/:provider/callback") do
    env['omniauth.auth'] # =&gt; OmniAuth::AuthHash
  end
end
</PRE>

<P>
Also of note, by default, if user authentication fails on the provider
side, OmniAuth will catch the response and then redirect the request
to the path <code>/auth/failure</code>,
 passing a corresponding error message in a
parameter named <code>message</code>. 

<P>
You may want to add an action to catch these
cases. Continuing with the previous Sinatra example, you could add an
action like this:

<P>
<PRE>
get '/auth/failure' do
  flash[:notice] = params[:message] # if using sinatra-flash or rack-flash
  redirect '/'
end
</PRE>

<P>

<H4><A NAME="SECTION07420020000000000000">
Strategies</A>
</H4>
  

<P>
In this link we can find a list of the strategies that are available for OmniAuth:
<A NAME="tex2html801"
  HREF="https://github.com/intridea/omniauth/wiki/List-of-Strategies">List of Strategies for Omniauth</A>.

<P>

<H2><A NAME="SECTION07421000000000000000">
Auth Hash Schema</A>
</H2>

<P>
<A NAME="tex2html802"
  HREF="https://github.com/intridea/omniauth/wiki/Auth-Hash-Schema">OmniAuth is a flexible authentication system utilizing Rack middleware.</A>
<P>
OmniAuth will always return a hash of information after authenticating
with an external provider in the Rack environment under the key
<code>omniauth.auth</code>. 

<P>
This information is meant to be as normalized as
possible, so the schema below will be filled to the greatest degree
available given the provider upon authentication. Fields marked required
will always be present. 

<P>

<UL>
<LI><code>provider (required)</code> The provider with which the user
authenticated (e.g. <code>twitter</code> or <code>facebook</code>)

<P>
</LI>
<LI><code>uid (required)</code> An identifier unique to the given provider,
such as a 
<FONT COLOR="#ff0000"> Twitter user ID</FONT>. Should be stored as a string.

<P>
</LI>
<LI><code>info (required)</code> A hash containing information about the user
  
<UL>
<LI><code>name (required)</code> The best display name known to the
strategy. Usually a concatenation of first and last name, but may also
be an arbitrary designator or nickname for some strategies
</LI>
<LI><code>email</code> The e-mail of the authenticating user. Should be provided if at all possible (but some sites such as Twitter do not provide this information)
</LI>
<LI><code>nickname</code> The username of an authenticating user (such
    as your <code>@-name</code> from Twitter or GitHub account name)
</LI>
<LI><code>first_name</code>
</LI>
<LI><code>last_name</code>
</LI>
<LI><code>location</code> The general location of the user, usually a city and state.
</LI>
<LI><code>description</code> A short description of the authenticating user.
</LI>
<LI><code>image</code> A URL representing a profile image of the
    authenticating user. Where possible, should be specified to a square,
    roughly 50x50 pixel image.
</LI>
<LI><code>phone</code> The telephone number of the authenticating user (no formatting is enforced).
</LI>
<LI><code>urls</code> A hash containing key value pairs of an identifier
    for the website and its URL. 

<P>
For instance, an entry could be 
<PRE>
"Blog" =&gt; "http://intridea.com/blog"
</PRE>
</LI>
</UL>
</LI>
<LI><code>credentials</code> If the authenticating service provides some
kind of access token or other credentials upon authentication, these
are passed through here.
</LI>
<LI><code>token</code> Supplied by OAuth and OAuth 2.0 providers, the access token.
</LI>
<LI><code>secret</code> Supplied by OAuth providers, the access token secret.
</LI>
<LI><code>extra</code> Contains extra information returned from the
authentication provider. May be in provider-specific formats.
</LI>
<LI><code>raw_info</code> A hash of all information gathered about a user
in the format it was gathered. 

<P>
For example, for Twitter users this is
a hash representing the JSON hash returned from the Twitter API.
</LI>
</UL>

<P>

<H4><A NAME="SECTION07421010000000000000">
Ejemplos</A>
</H4>
  

<P>

<UL>
<LI><A NAME="tex2html803"
  HREF="https://github.com/intridea/omniauth/wiki/Sinatra-Example">Omniauth Sinatra Example (Twitter y OpenID)</A>
</LI>
<LI><A NAME="tex2html804"
  HREF="https://gist.github.com/crguezl/9857758">Omniauth Sinatra Gist Example: Facebook, Twitter, GitHub</A>
</LI>
</UL>

<P>

<H4><A NAME="SECTION07421020000000000000">
Documentación de la Gema</A>
</H4>
  

<P>

<UL>
<LI><A NAME="tex2html805"
  HREF="http://rubydoc.info/github/intridea/omniauth/master/frames">API doc: OmniAuth: Standardized Multi-Provider Authentication</A>
</LI>
<LI><A NAME="tex2html806"
  HREF="http://rubydoc.info/github/intridea/omniauth/master/OmniAuth">Module: OmniAuth</A>
</LI>
<LI>Esta clase contiene información sobre el usuario.
<A NAME="tex2html807"
  HREF="http://rubydoc.info/github/intridea/omniauth/master/OmniAuth/AuthHash/InfoHash">Class: OmniAuth::AuthHash::InfoHash</A>
</LI>
</UL>

<P>

<H4><A NAME="SECTION07421030000000000000">
Véase</A>
</H4>
  

<UL>
<LI><A NAME="tex2html808"
  HREF="https://plus.google.com/+RaymondCamden/posts/idUKfLscAuV">Blog Post: ColdFusion and OAuth part 3- Google authentication.</A>
Raymond Camden
</LI>
<LI>
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<A NAME="tex2html6229"
  HREF="node203.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html6223"
  HREF="node200.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html6217"
  HREF="node201.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html6225"
  HREF="node217.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html6227"
  HREF="node220.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1314/course/view.php?id=1104"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html5"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html6"
  HREF="http://crguezl.github.io/pl-html/"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html7"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html8"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="github"></A><A NAME="tex2html9"
  HREF="https://plus.google.com/u/0/communities/107031495100582318205"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="comunidad g+ PL1314"></A><A NAME="tex2html10"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html12"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html13"
  HREF="https://github.com/crguezl"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="crguezl at github"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html6230"
  HREF="node203.html">OmniAuth OAuth2 gem</A>
<B>Sup:</B> <A NAME="tex2html6224"
  HREF="node200.html">Oauth: Google, Twitter, GitHub,</A>
<B> Ant:</B> <A NAME="tex2html6218"
  HREF="node201.html">Introduction to OAuth</A>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2014-03-30</I>
</ADDRESS>
</BODY>
</HTML>
