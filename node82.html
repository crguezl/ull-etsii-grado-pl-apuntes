<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Estructura de un programa LEX</TITLE>
<META NAME="description" CONTENT="Estructura de un programa LEX">
<META NAME="keywords" CONTENT="javascriptexamples">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="mystyle.css">

<LINK REL="next" HREF="node83.html">
<LINK REL="previous" HREF="node81.html">
<LINK REL="up" HREF="node81.html">
<LINK REL="next" HREF="node83.html">
</HEAD>

<BODY >

<DIV CLASS="navigation">
<A NAME="tex2html2756"
  HREF="node83.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2750"
  HREF="node81.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2744"
  HREF="node81.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2752"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2754"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="https://dl.dropbox.com/u/14539152/PLgrado/PLgradoBOOK/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html6"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html7"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="google code project hosting"></A><A NAME="tex2html8"
  HREF="http://jquery.com/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html9"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html10"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html12"
  HREF="http://crondinosaur.blogspot.com/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html2757"
  HREF="node83.html">Versi&#243;n Utilizada</A>
<B>Sup:</B> <A NAME="tex2html2751"
  HREF="node81.html">Expresiones Regulares en Flex</A>
<B> Ant:</B> <A NAME="tex2html2745"
  HREF="node81.html">Expresiones Regulares en Flex</A>
<B> Con:</B> 
<A NAME="tex2html2752"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<B> Ind:</B> 
<A NAME="tex2html2754"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR> <P>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsecciones</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><A NAME="tex2html2758"
  HREF="node82.html#SECTION05210010000000000000">Estructura de un programa</A>
<LI><A NAME="tex2html2759"
  HREF="node82.html#SECTION05210020000000000000">Compilación</A>
<LI><A NAME="tex2html2760"
  HREF="node82.html#SECTION05210030000000000000">Ejecución</A>
<LI><A NAME="tex2html2761"
  HREF="node82.html#SECTION05210040000000000000">Secci&#243;n de definiciones</A>
<LI><A NAME="tex2html2762"
  HREF="node82.html#SECTION05210050000000000000">El Lenguaje de las Expresiones Regulares Flex</A>
<LI><A NAME="tex2html2763"
  HREF="node82.html#SECTION05210060000000000000">Las Acciones Semánticas</A>
</UL></UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION05210000000000000000"></A>
<A NAME="section:estructuraflex"></A>
<BR>
Estructura de un programa LEX
</H1>

<P>

<H4><A NAME="SECTION05210010000000000000">
Estructura de un programa</A>
</H4>
  

<P>
 <TT>LEX</TT>  y  <TT>FLEX</TT>  son ejemplos de generadores léxicos.  <TT>Flex</TT> 
lee desde la entrada est&#225;ndar si no se especifica explícitamente
un fichero de entrada. El fichero de entrada <code>reglen.l</code> (se suele usar el tipo <code>l</code>)
debe tener la forma:
<BR>
<P>
<TT>%{              
<BR>
declaration C1              
<BR>.
<BR>.
<BR>.
<BR>
<BR>
declaration CM              
<BR>%}              
<BR>
macro_name1 regular_definition1                  
<BR>.
<BR>.
<BR>.
<BR>
<BR>
macro_nameR regular_definitionR                  
<BR></TT>
<P>
<TT>%x exclusive_state
<BR>%s inclusive_state
<BR>%%              
<BR>              
<BR>
regular_expression1 { action1(); }              
<BR>.
<BR>.
<BR>.
<BR>
<BR>
regular_expressionN { actionN(); }              
<BR>              
<BR>%%              
<BR>
support_routine1() {              
<BR>}              
<BR>.
<BR>.
<BR>.
<BR>
<BR>
support_routineS() {              
<BR>}              
<BR></TT>

<P>
Como vemos,  un programa <code>LEX</code> consta de 3 secciones, separadas
por <code>%%</code>. La primera secci&#243;n se denomina <A NAME="2837"></A><SPAN  CLASS="textit">secci&#243;n de
definiciones</SPAN>,
la segunda <A NAME="2839"></A><SPAN  CLASS="textit">secci&#243;n de reglas</SPAN> 
y la tercera <A NAME="2841"></A><SPAN  CLASS="textit">secci&#243;n de c&#243;digo</SPAN>. 
La primera y la &#250;ltima son opcionales, as&#305; el programa legal <code>LEX</code> mas simple es:

<P>
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=227><PRE>
%%
</PRE></TD>
</TR>
</TABLE>

<P>
que genera un analizador que copia su entrada en <code>stdout</code>.

<P>

<H4><A NAME="SECTION05210020000000000000">
Compilación</A>
</H4>
  

<P>
Una vez compilado el fichero de entrada <code>regleng.l</code>
mediante la correspondiente orden:

<P>
<code>flex reglen.l</code> 

<P>
obtenemos un fichero denominado <code>lex.yy.c</code>. Este fichero
contiene la rutina <code>yylex()</code> que realiza el an&#225;lisis l&#233;xico
del lenguaje descrito en <code>regleng.l</code>. Supuesto que una de las
<code>support_routines</code> es una funci&#243;n <code>main()</code> que llama a la
funci&#243;n <code>yylex()</code>, podemos compilar el fichero generado con un
compilador C para obtener un ejecutable <code>a.out</code>:

<P>
<code>cc lex.yy.c -lfl</code> 

<P>
La inclusi&#243;n de la opci&#243;n <code>-fl</code> enlaza con la
librer&#305;a de <code>flex</code>, que contiene dos funciones: <code>main</code>
y <code>yywrap()</code>.

<P>

<H4><A NAME="SECTION05210030000000000000">
Ejecución</A>
</H4>
  

<P>
Cuando ejecutamos el programa <code>a.out</code>, la funci&#243;n <code>yylex()</code>
analiza las entradas, buscando la secuencia mas larga que casa con alguna
de las expresiones regulares (<code>regular_expressionK</code>) y ejecuta la
correspondiente acci&#243;n (<code>actionK()</code>).
Si no se encuentra ningun  emparejamiento se ejecuta la <A NAME="2851"></A><SPAN  CLASS="textit">regla por defecto</SPAN>, que es:

<P>
<code>(.|\n)  { printf("%s",yytext); }</code>

<P>
Si encuentran dos expresiones regulares con las que la cadena mas larga
casa, elige la que figura primera en el programa <code>lex</code>.
Una vez que <code>yylex()</code> ha encontrado el <SPAN  CLASS="textit">token</SPAN>, esto es, el
patr&#243;n que casa con la cadena mas larga, dicha cadena queda disponible
a trav&#233;s del puntero global  <TT>yytext</TT> , y su longitud queda en la
variable entera global  <TT>yyleng</TT> .

<P>
Una vez que se ha ejecutado la correspondiente acci&#243;n, <code>yylex()</code>
contin&#250;a con el resto de la entrada, buscando por subsiguientes
emparejamientos. Asi continúa hasta encontrar un <code>end of file</code>,
en cuyo caso termina, retornando un cero o bien hasta que una de las
acciones explicitamente ejecuta una sentencia <code>return</code>.

<P>

<H4><A NAME="SECTION05210040000000000000">
Secci&#243;n de definiciones</A>
</H4>
  

<P>
La primera secci&#243;n contiene, si las hubiera,  las definiciones regulares
y las declaraciones de los estados de arranque.

<P>
Las definiciones tiene la forma:

<P>
<SPAN  CLASS="textit">name regular_definition</SPAN>

<P>
donde <SPAN  CLASS="textit">name</SPAN> puede ser descrito mediante la expresi&#243;n regular:

<P>
<code>[a-zA-Z_][a-zA-Z_0-9-]*</code> 

<P>
La <SPAN  CLASS="textit">regular_definition</SPAN> comienza en el primer car&#225;cter no
blanco que sigue a <SPAN  CLASS="textit">name</SPAN> y termina al final de la l&#305;nea. La
definici&#243;n es una expresi&#243;n regular extendida. Las subsiguientes
definiciones pueden ``llamar'' a la macro <code>{name}</code> escribi&#233;ndola
entre llaves. La macro se expande entonces a <code>(regular_definition)</code>
en <code>flex</code> y a <code>regular_definition</code> en <code>lex</code>.

<P>
El c&#243;digo entre los delimitadores <code>%{</code> y <code>%}</code> se copia
verbatim al fichero de salida, situ&#225;ndose en la parte de declaraciones
globales. Los delimitadores deben aparecer (s&#243;los) al comienzo de
la l&#305;nea.

<P>

<H4><A NAME="SECTION05210050000000000000">
El Lenguaje de las Expresiones Regulares Flex</A>
</H4>
  

<P>
La sint&#225;xis que puede utilizarse para la descripci&#243;n de las
expresiones regulares es la que se conoce como ``extendida'':

<P>

<UL>
<LI><code>x</code>	      Casa con 'x'
</LI>
<LI><code>.</code>	      Cualquier car&#225;cter, excepto <code>\n</code>.
</LI>
<LI><code>[xyz]</code>      Una ``clase''; en este caso una de las letras <code>x</code>, <code>y</code>, <code>z</code>
</LI>
<LI><code>[abj-oZ]</code>   Una ``clase'' con un rango; casa con  <code>a</code>,  <code>b</code>, cualquier letra desde  <code>j</code> hasta <code>o</code>, o una <code>Z</code>
</LI>
<LI><code>[^A-Z]</code>     Una ``Clase complementada'' esto es, todos los caracteres que no est&#225;n en la clase. Cualquier car&#225;cter, excepto las letras may&#250;sculas. Obs&#233;rvese que el retorno de carro <code>\n</code> casa
con esta expresion. As&#305; es posible que, &lt;un patr&#243;n como <code>[^"]+</code> pueda casar con todo el fichero!.
</LI>
<LI><code>[^A-Z\n]</code>   Cualquier car&#225;cter, excepto las letras may&#250;sculas o un <code>\n</code>.
</LI>
<LI><P>
<code>[[:alnum:]]</code> Casa con cualquier caracter alfanum&#233;rico. Aqui <code>[:alnum:]</code> se refiere a una de las clases predefinidas. Las otras clases son: <code>[:alpha:]</code> <code>[:blank:]</code> <code>[:cntrl:]</code> <code>[:digit:]</code> <code>[:graph:]</code> <code>[:lower:]</code> <code>[:print:]</code> <code>[:punct:]</code> <code>[:space:]</code> <code>[:upper:]</code> <code>[:xdigit:]</code>. Estas clases designan el mismo conjunto de caracteres que la correspondiente funci&#243;n C <code>isXXXX</code>.

<P>
</LI>
<LI><code>r*</code>	Cero o mas <code>r</code>.
</LI>
<LI><code>r+</code>       Una o mas <code>r</code>.
</LI>
<LI><code>r?</code>	Cero o una  <code>r</code>.
</LI>
<LI><code>r{2,5}</code>     Entre 2 y 5  <code>r</code>.
</LI>
<LI><code>r{2,}</code>      2 o mas <code>r</code>. 
<code>r{4}</code>	  Exactamente 4 <code>r</code>. 
</LI>
<LI><code>{macro_name}</code>     La expansi&#243;n de <code>macro_name</code> por su <SPAN  CLASS="textit">regular_definition</SPAN>
</LI>
<LI><code>"[xyz]\"foo"</code> Exactamente la cadena: [xyz]"foo
</LI>
<LI><code>\X</code>	      Si <code>X</code> is an <code>a</code>, <code>b</code>, <code>f</code>, <code>n</code>, <code>r</code>, <code>t</code>, o <code>v</code>, entonces, la interpretaci&#243;n ANSI-C de <code>\x</code>.  En cualquier otro caso <code>X</code>.
</LI>
<LI><code>\0</code>	      El car&#225;cter NUL (ASCII 0).
</LI>
<LI><code>\123</code>	      El car&#225;cter cuyo c&#243;digo octal es 123.
</LI>
<LI><code>\x2a</code>	      El car&#225;cter cuyo c&#243;digo hexadecimal es 2a.
</LI>
<LI><code>(r)</code>	      Los par&#233;ntesis son utilizados para cambiar la precedencia.
</LI>
<LI><code>rs</code>	      Concatenation
</LI>
<LI><code>r|s</code>	      Casa con  <code>r</code> o <code>s</code>
</LI>
<LI><code>r/s</code>	      Una <code>r</code> pero s&#243;lo si va seguida de una <code>s</code>. El texto casado con <code>s</code> se incluye a la hora de decidir cual es el emparejamiento mas largo, pero se devuelve a la entrada cuando se ejecuta la acci&#243;n. La acci&#243;n s&#243;lo ve el texto asociado con <code>r</code>. Este tipo de patr&#243;n se denomina <SPAN  CLASS="textit">trailing context</SPAN> o <SPAN  CLASS="textit">lookahead</SPAN> positivo.  
</LI>
<LI><code>^r</code>	      Casa con <code>r</code>, al comienzo de una l&#305;nea.
                      Un <code>^</code> que no aparece al comienzo de la l&#305;nea o un <code>$</code> que no aparece al final de la l&#305;nea, pierde su naturaleza de ``ancla'' y es tratado como un car&#225;cter ordinario. Asi: <code>foo|(bar$)</code> se empareja con <code>bar$</code>. Si lo que se quer&#305;a es la otra interpretaci&#243;n, es posible escribir <code>foo|(bar\n)</code>, o bien:
<PRE>
foo |
bar$   { /* action */ }
</PRE>
</LI>
<LI><code>r$</code>	      Casa con <code>r</code>, al final de una l&#305;nea. Este es tambi&#233;n un operador de <SPAN  CLASS="textit">trailing context</SPAN>. Una regla no puede tener mas de un operador de <SPAN  CLASS="textit">trailing context</SPAN>. Por ejemplo, la expresi&#243;n <code>foo/bar$</code> es incorrecta.
</LI>
<LI><code>&lt;s&gt;r</code>	      Casa con <code>r</code>, pero s&#243;lo si se est&#225; en el estado <code>s</code>.
</LI>
<LI><code>&lt;s1,s2,s3&gt;r</code>    Idem, si se esta en alguno de los estados <code>s1</code>, <code>s2</code>, or <code>s3</code>
</LI>
<LI><code>&lt;*&gt;r</code>	      Casa con <code>r</code> cualquiera que sea el estado, incluso si este es exclusivo.
</LI>
<LI><code>&lt;&lt;EOF&gt;&gt;</code>        Un final de fichero.
</LI>
<LI><code>&lt;s1,s2&gt;&lt;&lt;EOF&gt;&gt;</code> Un final de fichero, si los estados son <code>s1</code> o <code>s2</code>
</LI>
</UL>

<P>
Los operadores han sido listados en orden de precedencia, de la
mas alta a la mas baja. Por ejemplo <code>foo|bar+</code> es lo mismo que
<code>(foo)|(ba(r)+)</code>.

<P>

<H4><A NAME="SECTION05210060000000000000">
Las Acciones Semánticas</A>
</H4>
  

<P>
Cada patrón regular tiene su correspondiente acción asociada. El patrón
termina en el primer espacio en blanco (sin contar aquellos que están
entre comillas dobles o prefijados de secuencias de escape).
Si la acción comienza con <code>{</code>, entonces se puede extender a través
de multiples líneas, hasta la correspondiente <code>}</code>.  El programa
<code>flex</code>  no hace un análisis del código C dentro de la acción.
Existen tres directivas que pueden insertarse dentro de las acciones:
<code>BEGIN</code>, <code>ECHO</code> y <code>REJECT</code>. Su uso se muestra en los
subsiguientes ejemplos.

<P>
La secci&#243;n de c&#243;digo se copia verbatim en <code>lex.yy.c</code>. Es
utilizada para proveer las funciones de apoyo que se requieran para la
descripci&#243;n de las acciones asociadas con los patrones que parecen en
la secci&#243;n de reglas.

<P>

<DIV CLASS="navigation"><HR>
<A NAME="tex2html2756"
  HREF="node83.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2750"
  HREF="node81.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2744"
  HREF="node81.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2752"
  HREF="node216.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2754"
  HREF="node219.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> <A NAME="tex2html2"
  HREF="http://nereida.deioc.ull.es/~plgrado/index.html"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="logoLPP.png"
 ALT="PL"></A><A NAME="tex2html3"
  HREF="http://campusvirtual.ull.es/1213m2/course/view.php?id=271"><IMG
  WIDTH="50" ALIGN="BOTTOM" BORDER="0"
 SRC="moodleLHPlogo.jpeg"
 ALT="PL moodle"></A><A NAME="tex2html4"
  HREF="javascriptexamples.pdf"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="gv.jpeg"
 ALT="ps"></A><A NAME="tex2html5"
  HREF="https://dl.dropbox.com/u/14539152/PLgrado/PLgradoBOOK/index.html"><IMG
  WIDTH="60" ALIGN="BOTTOM" BORDER="0"
 SRC="lupa.gif"
 ALT="ruby gems"></A><A NAME="tex2html6"
  HREF="https://developer.mozilla.org/es/docs/JavaScript"><IMG
  WIDTH="30" ALIGN="BOTTOM" BORDER="0"
 SRC="perlonion.jpeg"
 ALT="perldoc"></A><A NAME="tex2html7"
  HREF="http://github.com"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="google-code-project-hosting.jpeg"
 ALT="google code project hosting"></A><A NAME="tex2html8"
  HREF="http://jquery.com/"><IMG
  WIDTH="27" ALIGN="BOTTOM" BORDER="0"
 SRC="perl6.jpg"
 ALT="blogs"></A><A NAME="tex2html9"
  HREF="http://www.google.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ggoogle.gif"
 ALT="google"></A><A NAME="tex2html10"
  HREF="http://www.ull.es/view/centros/etsii/Grado/es"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="etsii.png"
 ALT="etsii"></A><A NAME="tex2html11"
  HREF="http://www.ull.es/"><IMG
  WIDTH="35" ALIGN="BOTTOM" BORDER="0"
 SRC="ull.gif"
 ALT="ull"></A><A NAME="tex2html12"
  HREF="http://crondinosaur.blogspot.com/"><IMG
  WIDTH="32" ALIGN="BOTTOM" BORDER="0"
 SRC="logopcgull.gif"
 ALT="pcgull"></A>
<BR>
<B> Sig:</B> <A NAME="tex2html2757"
  HREF="node83.html">Versi&#243;n Utilizada</A>
<B>Sup:</B> <A NAME="tex2html2751"
  HREF="node81.html">Expresiones Regulares en Flex</A>
<B> Ant:</B> <A NAME="tex2html2745"
  HREF="node81.html">Expresiones Regulares en Flex</A>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<I>Casiano Rodríguez León <BR>
2013-04-05</I>
</ADDRESS>
</BODY>
</HTML>
